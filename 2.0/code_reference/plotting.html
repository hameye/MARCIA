
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="TestDesc">
      
      
      
      
        <link rel="canonical" href="https://hameye.github.io/MARCIA/2.0/code_reference/plotting.html">
      
      <link rel="icon" href="../assets/images/icon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.5">
    
    
      
        <title>Datacube - MARCIA Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../css/style.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mca" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#marcia.plotting.datacube-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MARCIA Documentation" class="md-header__button md-logo" aria-label="MARCIA Documentation" data-md-component="logo">
      
  <img src="../assets/images/icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MARCIA Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Datacube
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/hameye/marcia" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    hameye/marcia
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../index.html" class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../python_install.html" class="md-tabs__link">
        Installation
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../examples/quick-start.html" class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="datacube.html" class="md-tabs__link md-tabs__link--active">
        Code Documentation
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MARCIA Documentation" class="md-nav__button md-logo" aria-label="MARCIA Documentation" data-md-component="logo">
      
  <img src="../assets/images/icon.png" alt="logo">

    </a>
    MARCIA Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/hameye/marcia" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    hameye/marcia
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../python_install.html" class="md-nav__link">
        Python Installation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../marcia_install.html" class="md-nav__link">
        MARCIA Installation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../examples/quick-start.html" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Tutorial_fr.html" class="md-nav__link">
        Sample Classification
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Code Documentation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Code Documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Code Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" data-md-state="indeterminate" type="checkbox" id="__nav_4_1" checked>
      
      <label class="md-nav__link" for="__nav_4_1">
        Objects
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Objects" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Objects
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="datacube.html" class="md-nav__link">
        Datacube
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="mask.html" class="md-nav__link">
        Mask
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" data-md-state="indeterminate" type="checkbox" id="__nav_4_2" checked>
      
      <label class="md-nav__link" for="__nav_4_2">
        Fitting
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Fitting" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Fitting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="manual_fit.html" class="md-nav__link">
        Manual Fitting
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" data-md-state="indeterminate" type="checkbox" id="__nav_4_3" checked>
      
      <label class="md-nav__link" for="__nav_4_3">
        IO
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="IO" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          IO
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="data_io.html" class="md-nav__link">
        Datacube
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="mask_io.html" class="md-nav__link">
        Mask
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" checked>
      
      <label class="md-nav__link" for="__nav_4_4">
        Plotting
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Plotting" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Plotting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Datacube
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="plotting.html" class="md-nav__link md-nav__link--active">
        Datacube
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#marcia.plotting.datacube-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.biplot" class="md-nav__link">
    biplot()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.datacube_hist" class="md-nav__link">
    datacube_hist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.hist" class="md-nav__link">
    hist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.hist_in_mask" class="md-nav__link">
    hist_in_mask()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.mineralcube_hist" class="md-nav__link">
    mineralcube_hist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.plot" class="md-nav__link">
    plot()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.plot_minerals" class="md-nav__link">
    plot_minerals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.triplot" class="md-nav__link">
    triplot()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#marcia.plotting.datacube-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.biplot" class="md-nav__link">
    biplot()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.datacube_hist" class="md-nav__link">
    datacube_hist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.hist" class="md-nav__link">
    hist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.hist_in_mask" class="md-nav__link">
    hist_in_mask()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.mineralcube_hist" class="md-nav__link">
    mineralcube_hist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.plot" class="md-nav__link">
    plot()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.plot_minerals" class="md-nav__link">
    plot_minerals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#marcia.plotting.datacube.triplot" class="md-nav__link">
    triplot()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Datacube</h1>
                
                <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">




  <div class="doc doc-children">






<h2 id="marcia.plotting.datacube-functions">Functions<a href="#marcia.plotting.datacube-functions" class="headerlink" title="Permanent link">¤</a></h2>

  <div class="doc doc-object doc-function">



<h3 id="marcia.plotting.datacube.biplot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">biplot</span><span class="p">(</span><span class="n">datacube</span><span class="p">,</span> <span class="n">indicex</span><span class="p">,</span> <span class="n">indicey</span><span class="p">)</span></code>


<a href="#marcia.plotting.datacube.biplot" class="headerlink" title="Permanent link">¤</a></h3>

    <div class="doc doc-contents ">

      <p>Plot one element against another one in a scatter plot
Input is the indexes of each of the two element in the 3D array
Useful function in order to see elemental ratios and some
elemental thresholds.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>datacube</code></td>
        <td><code>DataCube</code></td>
        <td><p>Marcia DataCube Object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indicex</code></td>
        <td><code>str</code></td>
        <td><p>Element to plot on x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indicey</code></td>
        <td><code>str</code></td>
        <td><p>Element to plot on y-axis.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>marcia/plotting/datacube.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">biplot</span><span class="p">(</span><span class="n">datacube</span><span class="p">:</span> <span class="n">DataCube</span><span class="p">,</span>
           <span class="n">indicex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
           <span class="n">indicey</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot one element against another one in a scatter plot</span>
<span class="sd">    Input is the indexes of each of the two element in the 3D array</span>
<span class="sd">    Useful function in order to see elemental ratios and some</span>
<span class="sd">    elemental thresholds.</span>

<span class="sd">    Args:</span>
<span class="sd">        datacube: Marcia DataCube Object.</span>
<span class="sd">        indicex: Element to plot on x-axis.</span>
<span class="sd">        indicey: Element to plot on y-axis.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Conversion of given string indices to integer indices of the cubes</span>
    <span class="n">indicex</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">indicex</span><span class="p">))</span>
    <span class="n">indicey</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">indicey</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

    <span class="c1"># Number of points limited to 100,000 for computationnal time</span>

    <span class="n">Valuesx</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">data_cube</span><span class="p">[</span>
        <span class="p">:,</span> <span class="p">:,</span> <span class="n">indicex</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">data_cube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indicex</span><span class="p">])]</span>
    <span class="n">Valuesy</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">data_cube</span><span class="p">[</span>
        <span class="p">:,</span> <span class="p">:,</span> <span class="n">indicey</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">data_cube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indicey</span><span class="p">])]</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">Valuesx</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">Valuesy</span><span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Limit number of samples to 100,000</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of points limited to 100000&#39;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Valuesx</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Valuesy</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">Elements</span><span class="p">[</span><span class="n">indicex</span><span class="p">]))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">Elements</span><span class="p">[</span><span class="n">indicey</span><span class="p">]))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="marcia.plotting.datacube.datacube_hist" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datacube_hist</span><span class="p">(</span><span class="n">datacube</span><span class="p">,</span> <span class="n">indice</span><span class="p">)</span></code>


<a href="#marcia.plotting.datacube.datacube_hist" class="headerlink" title="Permanent link">¤</a></h3>

    <div class="doc doc-contents ">

      <p>Plot the elemental map on the left side an
the corresponding hitogram of intensity on the right side
Input is the index of the element in the 3D array
Useful function in order to set the threshold in the spreadsheet.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>datacube</code></td>
        <td><code>DataCube</code></td>
        <td><p>Marcia DataCube Object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indice</code></td>
        <td><code>str</code></td>
        <td><p>Element to plot.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>marcia/plotting/datacube.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">datacube_hist</span><span class="p">(</span><span class="n">datacube</span><span class="p">:</span> <span class="n">DataCube</span><span class="p">,</span>
                  <span class="n">indice</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the elemental map on the left side an</span>
<span class="sd">    the corresponding hitogram of intensity on the right side</span>
<span class="sd">    Input is the index of the element in the 3D array</span>
<span class="sd">    Useful function in order to set the threshold in the spreadsheet.</span>

<span class="sd">    Args:</span>
<span class="sd">        datacube: Marcia DataCube Object.</span>
<span class="sd">        indice: Element to plot.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Conversion of given string indices to integer indice of the cube</span>
    <span class="n">indice</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">indice</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="c1"># Keep only finite values</span>
    <span class="n">finite_data</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">datacube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indice</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span>
        <span class="n">datacube</span><span class="o">.</span><span class="n">datacube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indice</span><span class="p">])]</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">datacube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indice</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Carte élémentaire : </span><span class="si">{</span><span class="n">datacube</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">finite_data</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">finite_data</span><span class="p">,</span>
                 <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                 <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">finite_data</span><span class="p">))},</span>
                 <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Logarithm scale because background has a lof ot points and flatten</span>
    <span class="c1"># interesting information if linear</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histograme d&#39;intensité : </span><span class="si">{</span><span class="n">datacube</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="marcia.plotting.datacube.hist" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hist</span><span class="p">(</span><span class="n">datacube</span><span class="p">,</span> <span class="n">indice</span><span class="p">)</span></code>


<a href="#marcia.plotting.datacube.hist" class="headerlink" title="Permanent link">¤</a></h3>

    <div class="doc doc-contents ">

      <p>Plot elemental map and histogram of a specific element.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>datacube</code></td>
        <td><code>DataCube</code></td>
        <td><p>Marcia DataCube Object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indice</code></td>
        <td><code>str</code></td>
        <td><p>Element to plot.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>marcia/plotting/datacube.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">hist</span><span class="p">(</span><span class="n">datacube</span><span class="p">:</span> <span class="n">DataCube</span><span class="p">,</span>
         <span class="n">indice</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot elemental map and histogram of a specific element.</span>

<span class="sd">    Args:</span>
<span class="sd">        datacube: Marcia DataCube Object.</span>
<span class="sd">        indice: Element to plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">datacube</span><span class="p">)</span> <span class="o">==</span> <span class="n">MultiCube</span><span class="p">:</span>
        <span class="n">datacube_hist</span><span class="p">(</span><span class="n">datacube</span><span class="p">,</span> <span class="n">indice</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">datacube</span><span class="p">)</span> <span class="o">==</span> <span class="n">MineralCube</span><span class="p">:</span>
        <span class="n">mineralcube_hist</span><span class="p">(</span><span class="n">datacube</span><span class="p">,</span> <span class="n">indice</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">datacube</span><span class="p">)</span> <span class="o">==</span> <span class="n">HyperCube</span><span class="p">:</span>
        <span class="n">hypercube_hist</span><span class="p">(</span><span class="n">datacube</span><span class="p">,</span> <span class="n">indice</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s1">&#39;Method not implemented yet ... &#39;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="marcia.plotting.datacube.hist_in_mask" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hist_in_mask</span><span class="p">(</span><span class="n">data_cube</span><span class="p">,</span> <span class="n">mineral_cube</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">mineral</span><span class="p">)</span></code>


<a href="#marcia.plotting.datacube.hist_in_mask" class="headerlink" title="Permanent link">¤</a></h3>

    <div class="doc doc-contents ">

      <p>Plot elemental map and histogram
associated only for a specific element in a mineralcube.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data_cube</code></td>
        <td><code>DataCube</code></td>
        <td><p>DataCube to plot.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mineral_cube</code></td>
        <td><code>MineralCube</code></td>
        <td><p>MineralCube to check if element in mineral.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>element</code></td>
        <td><code>str</code></td>
        <td><p>Name of the wanted element (eg: 'Fe').</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mineral</code></td>
        <td><code>str</code></td>
        <td><p>Name of the wanted mask (eg: 'Galene').</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>      <div class="admonition note">
<p class="admonition-title">Note</p>
<p>Does not work if datacube is HyperCube (yet).</p>
</div>

        <details class="quote">
          <summary>Source code in <code>marcia/plotting/datacube.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">hist_in_mask</span><span class="p">(</span><span class="n">data_cube</span><span class="p">:</span> <span class="n">DataCube</span><span class="p">,</span>
                 <span class="n">mineral_cube</span><span class="p">:</span> <span class="n">MineralCube</span><span class="p">,</span>
                 <span class="n">element</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">mineral</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot elemental map and histogram</span>
<span class="sd">    associated only for a specific element in a mineralcube.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_cube: DataCube to plot.</span>
<span class="sd">        mineral_cube: MineralCube to check if element in mineral.</span>
<span class="sd">        element:  Name of the wanted element (eg: &#39;Fe&#39;).</span>
<span class="sd">        mineral:  Name of the wanted mask (eg: &#39;Galene&#39;).</span>

<span class="sd">    Note:</span>
<span class="sd">        Does not work if datacube is HyperCube (yet).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Conversion of given string indices to integer indices of the cubes</span>
    <span class="n">element</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_cube</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">element</span><span class="p">))</span>
    <span class="n">mineral</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mineral_cube</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mineral</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="n">Anan</span> <span class="o">=</span> <span class="n">data_cube</span><span class="o">.</span><span class="n">datacube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">element</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span>
        <span class="n">data_cube</span><span class="o">.</span><span class="n">datacube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">element</span><span class="p">])]</span>

    <span class="n">array</span> <span class="o">=</span> <span class="n">data_cube</span><span class="o">.</span><span class="n">datacube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">element</span><span class="p">]</span>
    <span class="n">array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mineral_cube</span><span class="o">.</span><span class="n">datacube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">mineral</span><span class="p">])]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Carte élémentaire de </span><span class="si">{</span><span class="n">data_cube</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="si">}</span><span class="s2"> masquéé par </span><span class="si">{</span><span class="n">mineral_cube</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">mineral</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Anan</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">Anan</span><span class="p">,</span>
                 <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                 <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Anan</span><span class="p">))},</span>
                 <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histograme d&#39;intensité : </span><span class="si">{</span><span class="n">data_cube</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="marcia.plotting.datacube.mineralcube_hist" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mineralcube_hist</span><span class="p">(</span><span class="n">mineral_cube</span><span class="p">,</span> <span class="n">indice</span><span class="p">)</span></code>


<a href="#marcia.plotting.datacube.mineralcube_hist" class="headerlink" title="Permanent link">¤</a></h3>

    <div class="doc doc-contents ">

      <p>Plot the elemental map on the left side an
the corresponding hitogram of probability to 
be in the mineral on the right side.
Input is the index of the element in the 3D array
Useful function in order to set the threshold in the spreadsheet.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mineral_cube</code></td>
        <td><code>MineralCube</code></td>
        <td><p>Marcia DataCube Object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indice</code></td>
        <td><code>str</code></td>
        <td><p>Element to plot.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>marcia/plotting/datacube.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mineralcube_hist</span><span class="p">(</span><span class="n">mineral_cube</span><span class="p">:</span> <span class="n">MineralCube</span><span class="p">,</span>
                     <span class="n">indice</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the elemental map on the left side an</span>
<span class="sd">    the corresponding hitogram of probability to </span>
<span class="sd">    be in the mineral on the right side.</span>
<span class="sd">    Input is the index of the element in the 3D array</span>
<span class="sd">    Useful function in order to set the threshold in the spreadsheet.</span>

<span class="sd">    Args:</span>
<span class="sd">        mineral_cube: Marcia DataCube Object.</span>
<span class="sd">        indice: Element to plot.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Conversion of given string indices to integer indice of the cube</span>
    <span class="n">indice</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mineral_cube</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">indice</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">mineral_cube</span><span class="o">.</span><span class="n">datacube</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span>
        <span class="n">mineral_cube</span><span class="o">.</span><span class="n">datacube</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">keepdims</span><span class="o">=</span><span class="n">mineral_cube</span><span class="o">.</span><span class="n">datacube</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="c1"># Keep only finite values</span>
    <span class="n">finite_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indice</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indice</span><span class="p">])]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">mineral_cube</span><span class="o">.</span><span class="n">datacube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indice</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Carte minérale : </span><span class="si">{</span><span class="n">mineral_cube</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">finite_data</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">finite_data</span><span class="p">,</span>
                 <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                 <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">finite_data</span><span class="p">))},</span>
                 <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Logarithm scale because background has a lof ot points and flatten</span>
    <span class="c1"># interesting information if linear</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histograme de probabilité : </span><span class="si">{</span><span class="n">mineral_cube</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="marcia.plotting.datacube.plot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">datacube</span><span class="p">,</span> <span class="n">indice</span><span class="p">)</span></code>


<a href="#marcia.plotting.datacube.plot" class="headerlink" title="Permanent link">¤</a></h3>

    <div class="doc doc-contents ">

      <p>Plot the mineral mask wanted
Input is the index of the mineral in the 3D array (cube).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>datacube</code></td>
        <td><code>DataCube</code></td>
        <td><p>Marcia DataCube Object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indice</code></td>
        <td><code>str</code></td>
        <td><p>Element to plot.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>marcia/plotting/datacube.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">datacube</span><span class="p">:</span> <span class="n">DataCube</span><span class="p">,</span>
         <span class="n">indice</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the mineral mask wanted</span>
<span class="sd">    Input is the index of the mineral in the 3D array (cube).</span>

<span class="sd">    Args:</span>
<span class="sd">        datacube: Marcia DataCube Object.</span>
<span class="sd">        indice: Element to plot.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Conversion of given string indices to integer indice of the cube</span>
    <span class="n">indice</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">indice</span><span class="p">))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">datacube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indice</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">indice</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="marcia.plotting.datacube.plot_minerals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_minerals</span><span class="p">(</span><span class="n">datacube</span><span class="p">)</span></code>


<a href="#marcia.plotting.datacube.plot_minerals" class="headerlink" title="Permanent link">¤</a></h3>

    <div class="doc doc-contents ">

      <p>For mineralogy purposes, valid only if all masks are minerals
Plot all the mask onto one picture in order to visualize
the classification. Each pixel correspond to only one mineral
at the time, if not, it is classified as "mixed".</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>datacube</code></td>
        <td><code>MineralCube</code></td>
        <td><p>Marcia MineralCube Object.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>marcia/plotting/datacube.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_minerals</span><span class="p">(</span><span class="n">datacube</span><span class="p">:</span> <span class="n">MineralCube</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For mineralogy purposes, valid only if all masks are minerals</span>
<span class="sd">    Plot all the mask onto one picture in order to visualize</span>
<span class="sd">    the classification. Each pixel correspond to only one mineral</span>
<span class="sd">    at the time, if not, it is classified as &quot;mixed&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        datacube: Marcia MineralCube Object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

    <span class="n">array</span><span class="p">,</span> <span class="n">proportion</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">map</span><span class="p">()</span>

    <span class="c1"># First plot to generate random colors</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>

    <span class="c1"># Store finite values for later purpose</span>
    <span class="n">finite_values_array</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">array</span><span class="p">)]</span>

    <span class="c1"># Check if mixed pixels, need to add one more value</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span>
            <span class="n">datacube</span><span class="o">.</span><span class="n">datacube</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">2</span>
    <span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">elements</span><span class="p">))</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">im</span><span class="o">.</span><span class="n">cmap</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Test if colors where specify in the table</span>
    <span class="k">if</span> <span class="n">datacube</span><span class="o">.</span><span class="n">_colors</span><span class="p">:</span>
        <span class="c1"># If true, specified values are replaced</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">_colors</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">_colors</span><span class="p">[</span><span class="n">value</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">colors</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">_colors</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>

    <span class="c1"># Generating the new colormap</span>
    <span class="n">new_colormap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

    <span class="c1"># Open new figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">array</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">new_colormap</span><span class="p">,</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="c1"># create a patch for every color</span>
    <span class="c1"># If true, there are mixed pixels: need to add a patch of mixte</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">elements</span><span class="p">):</span>
        <span class="n">patches</span> <span class="o">=</span> <span class="p">[</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">values</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datacube</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">proportion</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">proportion</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Misclassified: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">array</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">array</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">))</span>

    <span class="c1"># If False, just add patches of corresponding masks</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">patches</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">values</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datacube</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">proportion</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[:]</span>
            <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">proportion</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Finally add a patch to specify proporty of non-classified pixel</span>
    <span class="c1"># Two reasons : images is bigger than sample or misclassification</span>
    <span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Not classified: </span><span class="si">{</span><span class="nb">round</span><span class="p">((</span><span class="n">datacube</span><span class="o">.</span><span class="n">datacube</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="n">datacube</span><span class="o">.</span><span class="n">datacube</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">finite_values_array</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">datacube</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="n">datacube</span><span class="o">.</span><span class="n">datacube</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">))</span>

    <span class="c1"># Add patches to the legend</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patches</span><span class="p">,</span>
               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mineralogical classification - </span><span class="si">{</span><span class="n">datacube</span><span class="o">.</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1">#plt.tight_layout()</span>
    <span class="c1">#plt.axis(&#39;off&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="marcia.plotting.datacube.triplot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">triplot</span><span class="p">(</span><span class="n">datacube</span><span class="p">,</span> <span class="n">indicex</span><span class="p">,</span> <span class="n">indicey</span><span class="p">,</span> <span class="n">indicez</span><span class="p">)</span></code>


<a href="#marcia.plotting.datacube.triplot" class="headerlink" title="Permanent link">¤</a></h3>

    <div class="doc doc-contents ">

      <p>Plot one element against another one in a scatter plot
Input is the indexes of each of the two element in the 3D array
Useful function in order to see elemental ratios and some elemental
thresholds.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>datacube</code></td>
        <td><code>DataCube</code></td>
        <td><p>Marcia DataCube Object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indicex</code></td>
        <td><code>str</code></td>
        <td><p>Element to plot on x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indicey</code></td>
        <td><code>str</code></td>
        <td><p>Element to plot on y-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indicez</code></td>
        <td><code>str</code></td>
        <td><p>Element to color data with.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>marcia/plotting/datacube.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">triplot</span><span class="p">(</span><span class="n">datacube</span><span class="p">:</span> <span class="n">DataCube</span><span class="p">,</span>
            <span class="n">indicex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">indicey</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">indicez</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot one element against another one in a scatter plot</span>
<span class="sd">    Input is the indexes of each of the two element in the 3D array</span>
<span class="sd">    Useful function in order to see elemental ratios and some elemental</span>
<span class="sd">    thresholds.</span>

<span class="sd">    Args:</span>
<span class="sd">        datacube: Marcia DataCube Object.</span>
<span class="sd">        indicex: Element to plot on x-axis.</span>
<span class="sd">        indicey: Element to plot on y-axis.</span>
<span class="sd">        indicez: Element to color data with.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Conversion of given string indices to integer indices of the cubes</span>
    <span class="n">indicex</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">indicex</span><span class="p">))</span>
    <span class="n">indicey</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">indicey</span><span class="p">))</span>
    <span class="n">indicez</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">indicez</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">Valuesx</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">data_cube</span><span class="p">[</span>
        <span class="p">:,</span> <span class="p">:,</span> <span class="n">indicex</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">data_cube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indicex</span><span class="p">])]</span>
    <span class="n">Valuesy</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">data_cube</span><span class="p">[</span>
        <span class="p">:,</span> <span class="p">:,</span> <span class="n">indicey</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">data_cube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indicey</span><span class="p">])]</span>
    <span class="n">Valuesz</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">data_cube</span><span class="p">[</span>
        <span class="p">:,</span> <span class="p">:,</span> <span class="n">indicez</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">data_cube</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">indicez</span><span class="p">])]</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">Valuesx</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">Valuesy</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">Valuesz</span><span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of points limited to 100000&#39;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Valuesx</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Valuesy</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">Elements</span><span class="p">[</span><span class="n">indicez</span><span class="p">]))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">hue</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">Elements</span><span class="p">[</span><span class="n">indicex</span><span class="p">]))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">Elements</span><span class="p">[</span><span class="n">indicey</span><span class="p">]))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" title="Back to top" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="mask_io.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Mask
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 - 2021 Hadrien Meyer
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.sections", "navigation.expand", "navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.d351de03.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.a1609d9a.min.js"></script>
      
    
  </body>
</html>